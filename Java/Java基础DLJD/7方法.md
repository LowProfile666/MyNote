<center><h1>方法</h1></center>

[TOC]

# 一、概述

方法（method）是可以完成某个特定功能的并且可以被重复利用的代码片段，在C语言中方法被称为函数。

方法定义后需要调用才能执行。

---

# 二、语法机制

定义

```java
[修饰符列表] 返回值类型 方法名(形式参数列表){
    方法体；
}
注意：[] 是中括号，中括号中的内容表示不是必须的，是可选的。
```

修饰符列表：不是必选项，是可选的。

返回值：返回值一般指的是一个方法执行结束后的结果，通常是一个数据，所以被称为值；数据得有类型，所以有返回值类型。

返回值类型：

- 返回值类型可以是任何类型，只要是Java中合法的数据类型就行。
- 当一个方法执行结束不返回任何值的时候，返回值类型也不能空白，必须写void关键字，表示方法结束后不返回任何结果。
- 如果返回值类型不是void，那么方法执行结束的时候必须使用`return 值`的语句来完成值的返回。
- 只要有return关键字的语句执行，当前方法就必然结束。
- 如果返回值类型是void，就不能用 `return 值;`语句，只能用 “`return;`” 语句来终止当前方法。
- 除了 void 之外，剩下都必须有 “`return 值;`” 语句
- break和return的区别
  - break用来终止switch和离他最近的循环。
  - return用来终止离他最近的一个方法。

方法名：

- 方法名要见名知意（只要合法就行）。
- 方法名在标识符命名规范当中，要求首字母小写，后面每个单词首字母大写。

形式参数列表：

- 简称：形参。
- 注意：形参列表中的每个参数都是 “局部变量” ，方法结束之后内存释放。
- 形参有多个的话使用 “逗号” 隔开。
- 形参的数据类型起决定性作用。
- 形参和实参必须一一对应，数据类型对应、个数对应。

方法体：

- 有Java语句构成，Java语句以 `;` 结尾。
- 遵循自上而下的顺序依次逐行执行。

---

# 三、方法调用

方法必须调用才能执行。

调用语法：`类名.方法名(实际参数列表);`。

+ A方法调用B方法的时候，A和B都在同一个类中，“`类名.`”可以省略，如果不在同一类中不能省略。

调用程序不一定写在main方法中。

## 1、接受返回值

- 使用变量接收方法的返回值。
- 注意：变量的定义需要指定变量的数据类型。
- 可以不接受返回值，返回之后内存马上释放。

---

## 2、缺少返回语句

```java
public static int fun(){
    boolean b = true;
    // 编译器不负责运行程序，编译器只知道b是布尔类型变量，他认为b有可能是true和false
    if(b){
        // 编译器觉得以下代码可能执行也可能不会执行
        // 为了保证程序不出问题，所以编译器会报错：
        // 错误：缺少返回语句。
        return 1;
    }
}
```

---

# 四、JVM的内存

JVM中主要的三块内存：栈、堆、方法区（还有其他的）。![image](https://gitee.com/zsm666/image-bed/raw/master/img/JVM%E7%9A%84%E4%B8%89%E5%A4%A7%E5%86%85%E5%AD%98.jpg)

## 1、栈数据结构

什么是数据结构：存储数据的容器。数据结构和Java语言实际上没有关系；Java语言把常用的数据结构都写好了。

栈Stack：

![image](https://gitee.com/zsm666/image-bed/raw/master/img/%E6%A0%88%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.jpg)

---

## 2、方法执行时的内存

局部变量：只在方法体中有效，方法结束之后，局部变量的内存就释放了。方法不调用是不会在栈区中分配空间的。

方法调用叫做：压栈，分配空间。方法只有在调用时就会在栈中分配空间，并且调用时就是压栈。

方法结束叫做弹栈，释放空间。方法结束后，空间释放，此时发生弹栈。

比如：

```java
public class Test{
    public static void main(String[] args){
        m1(100);
    }
    public static void m1(int i){
        m2(i);
    }
    public static void m2(int i){
        System.out.println("hwllo world");
    }
}
```

![image](https://gitee.com/zsm666/image-bed/raw/master/img/%E6%96%B9%E6%B3%95%E5%8E%8B%E6%A0%88%E5%BC%B9%E6%A0%88.jpg)

---

# 五、方法重载

优点：

+ 代码整齐美观

+ 功能相似的，可以让方法名相同，更易于以后的代码代码编写。

  ```java
  public static void main(String[] args){
      sum(10, 20);
      sum(10.2, 3.14);
  }
  public static int sum(int a, int b){
      return a + b;
  }
  public static double sum(double a, double b){
      return a + b;
  }
  ```

Java怎么区分方法？

- 首先通过方法名区分。
- 方法名相同的情况下，通过方法的参数类型进行方法的区分。

什么时候使用方法重载？在同一个类中，功能相似的方法可以考虑将他们的方法名一致，容易记忆、方便使用。

## 1、条件

- 1、在同一个类中，
- 2、方法名相同，
- 3、参数列表不同（个数、类型、顺序）。

只要同时满足以上3个条件，就发生了重载。

方法重载与返回值类型无关。方法重载与修饰符列表无关。

```java
// 以下都是方法重复
// 方法重载与返回值类型无关
public static int m(){
    return 0;
}
public static double m(){
    return 1.0;
}
// 方法重载与修饰符列表无关
int m(){
    return 0;
}
public static int m(){
    return 0;
}
```

---

# 六、方法递归

递归：方法自己调用自己。

递归必须要有结束条件：当递归程序没有结束条件时，会发生栈溢出错误：`StackOverflowError`。

有时候有结束条件也可能会发生递归（递归太深了，栈内存不够）。

当递归栈溢出时：

- 1、先检查结束条件
- 2、可以手动调整JVM的栈内存初始化大小，可以调大一点（`java -x`  这个命令可以查看调整堆栈大小的参数）。